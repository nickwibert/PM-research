colnames(data1) = c("Y", "X")
data1 = data.frame(data1)
## Fit baseline-category logit model
## (without considering ordinality)
blogit.1A <- vglm(Y ~ X, family=multinomial, data=data1)
summary(blogit.1A)
## Fit null model
blogit.null.1A <- vglm(Y ~ 1, family=multinomial, data=data1)
summary(blogit.null.1A)
# Perform nested model LR test
lrtest(blogit.1A, blogit.null.1A)
getwd()
1-pchisq(15.52,1)
1-pchisq(15.52,4)
1-pchisq(15.52,3)
## Compare models using an LRT
lrtest(fit.blogit, fit.blogit_null)
## Read data in
income=c(3,10,20,30)
VD=c(2,2,0,0)
LD=c(4,6,1,3)
MS=c(13,22,15,13)
VS=c(3,4,8,8)
dat=data.frame(income,VD,LD,MS,VS)
dat
## Fit baseline-category logit model
fit.blogit=vglm(cbind(VD,LD,MS,VS)~income,family=multinomial,data=dat)
## Summary of results
summary(fit.blogit, hde.NA=FALSE)
## Fitted values
FV1 = fitted(fit.blogit)
FV1
## fit the null model
fit.blogit_null = vglm(cbind(VD, LD,MS,VS)~1,family=multinomial,data=dat)
summary(fit.blogit_null)
## Look at fitted values from this model
FV0 = fitted(fit.blogit_null)
FV0
## Compare models using an LRT
lrtest(fit.blogit, fit.blogit_null)
## 1E)
## Fit proportional odds model incoroprating
## ordinality of Y
clogit.1E <- vglm(Y ~ X,
family=cumulative(parallel=TRUE),
data=data1, hde.NA=FALSE)
summary(clogit.1E)
## 1F)
## Fit null proportional odds model
clogit.null.1E <- vglm(Y ~ X,
family=cumulative(parallel=TRUE),
data=data1, hde.NA=FALSE)
summary(clogit.null.1E)
## 1F)
## Fit null proportional odds model
clogit.null.1E <- vglm(Y ~ 1,
family=cumulative(parallel=TRUE),
data=data1, hde.NA=FALSE)
summary(clogit.null.1E)
# Perform LR test to check proportional odds assumption
lrtest(clogit.1E, clogit.null.1E)
## 1G)
## Fit cumulative logit model WITHOUT proportional
## odds assumption
clogit.1E <- vglm(Y ~ X,
family=cumulative(parallel=FALSE),
data=data1, hde.NA=FALSE)
## 1G)
## Fit cumulative logit model WITHOUT proportional
## odds assumption
clogit.1G <- vglm(Y ~ X,
family=cumulative(parallel=FALSE),
data=data1, hde.NA=FALSE)
summary(clogit.1G)
summary(clogit.1G, hde.NA=FALSE)
summary(clogit.1G, hde.NA=FALSE)
## 1G)
## Fit cumulative logit model WITHOUT proportional
## odds assumption
clogit.1G <- vglm(Y ~ X,
family=cumulative(parallel=FALSE),
data=data1, hde.NA=FALSE)
summary(clogit.1G, hde.NA=FALSE)
summary(clogit.1G)
## 1I)
## Perform LRT to compare prop. odds model to
## model without prop. odds
lrtest(clogit.1E, clogit.1G)
## 1I)
## Perform LRT to compare prop. odds model to
## model without prop. odds
lrtest(clogit.1G, clogit.1E)
## 1G)
## Fit cumulative logit model WITHOUT proportional
## odds assumption
clogit.1G <- vglm(Y ~ X,
family=cumulative(parallel=FALSE),
data=data1, hde.NA=FALSE)
summary(clogit.1G)
## 1I)
## Perform LRT to compare prop. odds model to
## model without prop. odds
lrtest(clogit.1G, clogit.1E)
## Doing an LRT to compare proportional odds model to one without proportional odds
lrtest(fit.clogit2, fit.clogit1)
## Assuming NON-parallel lines
fit.clogit2=vglm(cbind(VD,LD,MS,VS)~income,family=cumulative(parallel=FALSE),data=dat)
## Summary of model
summary(fit.clogit2, hde.NA=FALSE)
## Doing an LRT to compare proportional odds model to one without proportional odds
lrtest(fit.clogit2, fit.clogit1)
## Now fit the proportional odds model incorporating ordinality of outcome
fit.clogit1=vglm(cbind(VD,LD,MS,VS)~income,
family=cumulative(parallel=TRUE),data=dat, hde.NA=FALSE)
## Model summary
summary(fit.clogit1)
## Doing an LRT to compare proportional odds model to one without proportional odds
lrtest(fit.clogit2, fit.clogit1)
# Perform LR test to check proportional odds assumption
lrtest(clogit.1E, clogit.null.1E)
## Group level data
Y <- c(1,2,3,4)
X <- c(1,2,3)
data1.count <- expand.grid(Y,X)
count <- c(15,8,7,4,9,30,15,30,28,51,55,83)
data1.count <- cbind(data1.count, count)
colnames(data1.count) <- c("Y", "X", "count")
summary(data1.count)
head(data1.count)
tail(data1.count)
data1.count
dat
summary(clogit.1G)
## 1I)
## Perform LRT to compare prop. odds model to
## model without prop. odds
lrtest(clogit.1G, clogit.1E)
## 1I)
## Perform LRT to compare prop. odds model to
## model without prop. odds
lrtest(clogit.1E, clogit.1E)
## 1I)
## Perform LRT to compare prop. odds model to
## model without prop. odds
lrtest(clogit.1E, clogit.1E)
## 1I)
## Perform LRT to compare prop. odds model to
## model without prop. odds
lrtest(clogit.1E, clogit.1G)
## 1I)
## Perform LRT to compare prop. odds model to
## model without prop. odds
lrtest(clogit.1E, clogit.1G)
## 1G)
## Fit cumulative logit model WITHOUT proportional
## odds assumption
clogit.1G <- vglm(Y ~ X,
family=cumulative(parallel=FALSE),
data=data1, hde.NA=FALSE)
summary(clogit.1G)
summary(clogit.1E)
## Now fit the proportional odds model incorporating ordinality of outcome
fit.clogit1=vglm(cbind(VD,LD,MS,VS)~income,
family=cumulative(parallel=TRUE),data=dat, hde.NA=FALSE)
## Model summary
summary(fit.clogit1)
## Assuming NON-parallel lines
fit.clogit2=vglm(cbind(VD,LD,MS,VS)~income,family=cumulative(parallel=FALSE),data=dat)
## Summary of model
summary(fit.clogit2, hde.NA=FALSE)
## 1E)
## Fit proportional odds model incorporating
## ordinality of Y
clogit.1E <- vglm(Y ~ X,
family=cumulative(parallel=TRUE),
data=data1, hde.NA=FALSE)
summary(clogit.1E)
## 1G)
## Fit cumulative logit model WITHOUT proportional
## odds assumption
clogit.1G <- vglm(Y ~ X,
family=cumulative(parallel=FALSE),
data=data1, hde.NA=FALSE)
summary(clogit.1G)
summary(clogit.1G)
## 1I)
## Perform LRT to compare prop. odds model to
## model without prop. odds
lrtest(clogit.1E, clogit.1G)
## 1E)
## Fit proportional odds model incorporating
## ordinality of Y
clogit.1E <- vglm(Y ~ X,
family=cumulative(parallel=TRUE),
data=data1, hde.NA=FALSE)
summary(clogit.1E)
## 1F)
## Fit null proportional odds model
clogit.null.1E <- vglm(Y ~ 1,
family=cumulative(parallel=TRUE),
data=data1, hde.NA=FALSE)
summary(clogit.null.1E)
# Perform LR test to check proportional odds assumption
lrtest(clogit.1E, clogit.null.1E)
## 1G)
## Fit cumulative logit model WITHOUT proportional
## odds assumption
clogit.1G <- vglm(Y ~ X,
family=cumulative(parallel=FALSE),
data=data1, hde.NA=FALSE)
summary(clogit.1G)
## 1I)
## Perform LRT to compare prop. odds model to
## model without prop. odds
lrtest(clogit.1E, clogit.1G)
1-pchisq(0.6814, 2)
# Perform LR test to check effect of X
lrtest(clogit.1E, clogit.null.1E)
## 1E)
## Fit proportional odds model incorporating
## ordinality of Y
clogit.1E <- vglm(Y ~ X,
family=cumulative(parallel=TRUE),
data=data1, hde.NA=FALSE)
summary(clogit.1E)
## 1F)
## Fit null proportional odds model
clogit.null.1E <- vglm(Y ~ 1,
family=cumulative(parallel=TRUE),
data=data1, hde.NA=FALSE)
summary(clogit.null.1E)
# Perform LR test to check effect of X
lrtest(clogit.1E, clogit.null.1E)
1 - pchisq(14.951,1)
# Perform nested model LR test
lrtest(blogit.1A, blogit.null.1A)
# Perform LR test to check effect of X
lrtest(clogit.1E, clogit.null.1E)
## another LRT to compare, but without prop odds
fit.clogit_null2 = vglm(cbind(VD,LD,MS,VS)~1,family=cumulative(parallel=FALSE),data=dat)
lrtest(fit.clogit2, fit.clogit_null2)
## And do an LRT to compare the two
lrtest(fit.clogit1, fit.clogit_null)
## Can fit model without income
fit.clogit_null = vglm(cbind(VD,LD,MS,VS)~1,family=cumulative(parallel=TRUE),data=dat)
## And do an LRT to compare the two
lrtest(fit.clogit1, fit.clogit_null)
## Assuming NON-parallel lines
fit.clogit2=vglm(cbind(VD,LD,MS,VS)~income,family=cumulative(parallel=FALSE),data=dat)
lrtest(fit.clogit2, fit.clogit_null2)
data1
## 1E)
## Fit proportional odds model incorporating
## ordinality of Y
clogit.1E <- vglm(Y ~ X,
family=cumulative(parallel=TRUE),
data=data1, hde.NA=FALSE)
summary(clogit.1E)
## 1G)
## Fit cumulative logit model WITHOUT proportional
## odds assumption
clogit.1G <- vglm(Y ~ as.factor(X),
family=cumulative(parallel=TRUE),
data=data1, hde.NA=FALSE)
summary(clogit.1G)
## 1I)
## Perform LRT to compare prop. odds model to
## model without prop. odds
lrtest(clogit.1E, clogit.1G)
## 1E)
## Fit proportional odds model incorporating
## ordinality of Y
clogit.1E <- vglm(Y ~ X,
family=cumulative(parallel=FALSE),
data=data1, hde.NA=FALSE)
summary(clogit.1E)
## 1E)
## Fit proportional odds model incorporating
## ordinality of Y
clogit.1E <- vglm(Y ~ X,
family=cumulative(parallel=TRUE),
data=data1, hde.NA=FALSE)
summary(clogit.1E)
## 1G)
## Fit proportional odds model incorporating
## ordinality of X AND Y
clogit.1G <- vglm(Y ~ as.factor(X),
family=cumulative(parallel=TRUE),
data=data1, hde.NA=FALSE)
summary(clogit.1G)
summary(clogit.1E)
## 1I)
## Perform LRT to compare prop. odds model to
## model without prop. odds
lrtest(clogit.1E, clogit.1G)
## 1G)
## Fit proportional odds model incorporating
## ordinality of X AND Y
clogit.1G <- vglm(Y ~ X,
family=cumulative(parallel=FALSE),
data=data1, hde.NA=FALSE)
summary(clogit.1G)
## 1I)
## Perform LRT to compare prop. odds model to
## model without prop. odds
lrtest(clogit.1E, clogit.1G)
## 1E)
## Fit proportional odds model incorporating
## ordinality of Y
clogit.1E <- vglm(Y ~ X,
family=cumulative(parallel=TRUE),
data=data1, hde.NA=FALSE)
summary(clogit.1E)
# Perform LR test to check effect of X
lrtest(clogit.1E, clogit.null.1E)
## 1G)
## Fit proportional odds model incorporating
## ordinality of X AND Y
clogit.1G <- vglm(Y ~ as.factor(X),
family=cumulative(parallel=FALSE),
data=data1, hde.NA=FALSE)
summary(clogit.1G)
## 1I)
## Perform LRT to compare prop. odds model to
## model without prop. odds
lrtest(clogit.1E, clogit.1G)
## 1G)
## Fit proportional odds model incorporating
## ordinality of X AND Y
clogit.1G <- vglm(Y ~ as.factor(X),
family=cumulative(parallel=TRUE),
data=data1, hde.NA=FALSE)
summary(clogit.1G)
## 1I)
## Perform LRT to compare prop. odds model to
## model without prop. odds
lrtest(clogit.1E, clogit.1G)
## 1G)
## Fit proportional odds model incorporating
## ordinality of X AND Y
clogit.1G <- vglm(Y ~ cs(X),
family=cumulative(parallel=TRUE),
data=data1, hde.NA=FALSE)
install.packages("brm")
install.packages("brms")
library(brms)
clogit.test <- brm(Y ~ X, family=cumulative(),data=data1)
library(brm)
clogit.test <- brm(Y ~ X, family=cumulative(),data=data1)
library(brms)
detach(brm)
detach("brm")
detach(package:brm)
brm()
library(brms)
install.packages("brms")
brms::brm()
brm()
clogit.test <- vglm(Y ~ cs(X), family=acat(parallel=TRUE),
data=data1, hde.NA=FALSE)
summary(clogit.test)
clogit.test <- vglm(Y ~ X, family=acat(parallel=TRUE),
data=data1, hde.NA=FALSE)
summary(clogit.test)
clogit.test <- vglm(Y ~ cs(X), family=acat(parallel=TRUE),
data=data1, hde.NA=FALSE)
vignette("brms_overview")
vignette("brms_overview")
brms::cs()
VGAM::cs()
cs()
help(brmsformula)
??brmsfomrula
brmsformula()
library(brms)
brmsformula()
detach(package:brms)
detach(package:MASS)
detach(package:VGAM)
library(VGAM)
library(brms)
brm()
brms::brmsformula
brms::brmsformula()
install.packages("htmltools")
install.packages("htmltools")
detach(package:brms)
library(brms)
clogit.test <- vglm(Y ~ cs(X), family=acat(parallel=TRUE),
data=data1, hde.NA=FALSE)
library(VGAM)
clogit.test <- vglm(Y ~ cs(X), family=acat(parallel=TRUE),
data=data1, hde.NA=FALSE)
nsummary(clogit.test)
summary(clogit.test)
clogit.test <- vglm(Y ~ cs(X), family=acat(),
data=data1, hde.NA=FALSE)
summary(clogit.test)
clogit.test <- vglm(Y ~ cs(X), family=acat(),
data=data1, hde.NA=FALSE)
summary(clogit.test)
summary(clogit.1E)
clogit.test <- vglm(Y ~ cs(X), family=cumulative,
data=data1, hde.NA=FALSE)
summary(clogit.test)
clogit.test <- vglm(Y ~ cs(X), family=cumulative,
data=data1, hde.NA=FALSE)
clogit.test <- vglm(Y ~ cs(X), family=acat,
data=data1, hde.NA=FALSE)
summary(clogit.test)
clogit.test <- vglm(Y ~ cs(X), family=acat,
data=data1, hde.NA=FALSE)
## 1E)
## Fit proportional odds model incorporating
## ordinality of Y
clogit.1E <- vglm(Y ~ X,
family=cumulative(parallel=TRUE),
data=data1, hde.NA=FALSE)
summary(clogit.1E)
clogit.test <- brm(Y ~ X, family=cumulative(parallel=TRUE),
data=data1, hde.NA=FALSE)
summary(clogit.test)
clogit.test <- brm(Y ~ X, family=cumulative,
data=data1, hde.NA=FALSE)
clogit.test <- brm(Y ~ X, family=cumulative(),
data=data1, hde.NA=FALSE)
summary(clogit.test)
clogit.test <- brm(Y ~ X, family=cumulative(),
data=data1, hde.NA=FALSE)
detach(package:brm)
clogit.test <- brm(Y ~ X, family=cumulative(),
data=data1, hde.NA=FALSE)
clogit.test <- brm(Y ~ X, family=acat(),
data=data1, hde.NA=FALSE)
clogit.test <- vglm(Y ~ X, partial=~X)
clogit.test <- vglm(Y ~ X, partial=X)
clogit.test <- vglm(Y ~ cs(X),
family=acat(),
data=data1)
clogit.test <- vglm(Y ~ cs(X), family=acat(),
data=data1)
clogit.test <- vglm(cs(Y) ~ cs(X), family=acat(),
data=data1)
clogit.test <- brm(Y ~ cs(X), family=acat(),
data=data1)
clogit.test <- brm(Y ~ cs(X), family=acat(),
data=data1)
library(brms)
clogit.test <- brm(Y ~ cs(X), family=acat(),
data=data1)
summary(clogit.null.1E)
summary(clogit.test)
summary(clogit.null.1E)
summary(clogit.1G)
summary(clogit.1G)
detach(package:brms)
summary(clogit.1G)
## Read data in
income=c(3,10,20,30)
VD=c(2,2,0,0)
LD=c(4,6,1,3)
MS=c(13,22,15,13)
VS=c(3,4,8,8)
dat=data.frame(income,VD,LD,MS,VS)
dat
## Fit baseline-category logit model
fit.blogit=vglm(cbind(VD,LD,MS,VS)~income,family=multinomial,data=dat)
## Summary of results
summary(fit.blogit, hde.NA=FALSE)
plot(r,1:6, breaks=c(seq(0,50,5)), col=rev(brewer.pal(11,"RdYlBu")),
xlab="Longitude", ylab="Latitude")
plot(r,7:12, breaks=c(seq(0,50,5)), col=rev(brewer.pal(11,"RdYlBu")),
xlab="Longitude", ylab="Latitude")
plot(r,13:19, breaks=c(seq(0,50,5)), col=rev(brewer.pal(11,"RdYlBu")),
xlab="Longitude", ylab="Latitude")
year <- 2000
filename <- paste("data/V4NA03_PM25_NA_", year, '01_', year, '12-RH35.nc', sep="")
r <- stack(raster(filename, varname = "PM25"))
library(ncdf4)
library(chron)
library(lattice)
library(RColorBrewer)
library(raster)
library(rgdal)
library(ggplot2)
year <- 2000
filename <- paste("data/V4NA03_PM25_NA_", year, '01_', year, '12-RH35.nc', sep="")
r <- stack(raster(filename, varname = "PM25"))
for (year in 2001:2018)
{
filename <- paste("data/V4NA03_PM25_NA_", year, '01_', year, '12-RH35.nc', sep="")
r <- stack(r, raster(filename, varname = "PM25"))
}
year <- 2000
filename <- paste("data/V4NA03_PM25_NA_", year, '01_', year, '12-RH35.nc', sep="")
r <- stack(raster(filename, varname = "PM25"))
getwd()
setwd("C:/Users/nickw/OneDrive/Desktop/UF/Undergrad Research/PM-research")
filename <- paste("data/V4NA03_PM25_NA_", year, '01_', year, '12-RH35.nc', sep="")
r <- stack(raster(filename, varname = "PM25"))
for (year in 2001:2018)
{
filename <- paste("data/V4NA03_PM25_NA_", year, '01_', year, '12-RH35.nc', sep="")
r <- stack(r, raster(filename, varname = "PM25"))
}
names(r) <- c(2000:2018)
plot(r,1:6, breaks=c(seq(0,50,5)), col=rev(brewer.pal(11,"RdYlBu")),
xlab="Longitude", ylab="Latitude")
plot(r,7:12, breaks=c(seq(0,50,5)), col=rev(brewer.pal(11,"RdYlBu")),
xlab="Longitude", ylab="Latitude")
plot(r,13:19, breaks=c(seq(0,50,5)), col=rev(brewer.pal(11,"RdYlBu")),
xlab="Longitude", ylab="Latitude")
